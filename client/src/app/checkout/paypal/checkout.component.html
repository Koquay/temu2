<div class="container mt-4">
  <form #checkoutForm="ngForm">
    <section>
      <div class="row">
        <div class="col col-12 col-lg-8">
          <section>
            <div class="row mb-4">
              <div class="col">
                <label class="form-label fw-bold">First Name</label>
                <input
                  class="form-control"
                  type="text"
                  name="firstName"
                  [(ngModel)]="checkoutData.deliveryAddress.firstName"
                  required
                  #firstName="ngModel"
                  (change)="saveCheckoutData()"
                />
                <div
                  *ngIf="
                    firstName.invalid && (firstName.dirty || firstName.touched)
                  "
                  class="alert"
                >
                  <div *ngIf="firstName.hasError('required')" class="alert">
                    <small>First Name is required.</small>
                  </div>
                </div>
              </div>
              <div class="col">
                <label class="form-label fw-bold">Last Name</label>
                <input
                  class="form-control"
                  type="text"
                  name="lastName"
                  [(ngModel)]="checkoutData.deliveryAddress.lastName"
                  required
                  #lastName="ngModel"
                  (change)="saveCheckoutData()"
                />
                <div
                  *ngIf="
                    lastName.invalid && (lastName.dirty || lastName.touched)
                  "
                  class="alert"
                >
                  <div *ngIf="lastName.hasError('required')">
                    <small>Last Name is required.</small>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mb-4">
              <div class="col">
                <label class="form-label fw-bold">Phone Number</label>
                <input
                  class="form-control"
                  type="text"
                  name="phone"
                  [(ngModel)]="checkoutData.deliveryAddress.phone"
                  required
                  #phone="ngModel"
                  (change)="saveCheckoutData()"
                />
                <div
                  *ngIf="phone.invalid && (phone.dirty || phone.touched)"
                  class="alert"
                >
                  <div *ngIf="phone.hasError('required')">
                    <small>Phone is required.</small>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mb-4">
              <div class="col">
                <label class="form-label fw-bold">Delivery Address</label>
                <input
                  class="form-control"
                  type="text"
                  name="address1"
                  [(ngModel)]="checkoutData.deliveryAddress.address1"
                  required
                  #address1="ngModel"
                  (change)="saveCheckoutData()"
                />
                <div
                  *ngIf="
                    address1.invalid && (address1.dirty || address1.touched)
                  "
                  class="alert"
                >
                  <div *ngIf="address1.hasError('required')">
                    <small>Delivery Address is required.</small>
                  </div>
                </div>
              </div>
            </div>
            <div class="row mb-4">
              <div class="col">
                <label class="form-label fw-bold"
                  >Delivery Address Line 2 (Optional)</label
                >
                <input
                  class="form-control"
                  type="text"
                  name="address2"
                  [(ngModel)]="checkoutData.deliveryAddress.address2"
                  #address2="ngModel"
                  (change)="saveCheckoutData()"
                />
              </div>
            </div>
            <div class="row mb-4">
              <div class="col">
                <div class="form-check">
                  <input
                    class="form-check-input"
                    type="checkbox"
                    id="formCheck-1"
                    name="useAsBillingAddress"
                    [(ngModel)]="
                      checkoutData.deliveryAddress.useAsBillingAddress
                    "
                    required
                    #useAsBillingAddress="ngModel"
                    (change)="saveCheckoutData()"
                  />
                  <label class="form-check-label fw-bold" for="formCheck-1"
                    >Use as Billing Address</label
                  >
                </div>
              </div>
            </div>
          </section>

          <section>
            <div class="row mb-4">
              <div class="col">
                <div class="form-check" name="">
                  <input
                    class="form-check-input"
                    type="radio"
                    id="formCheck-2"
                    value="PayPal"
                    name="paymentMethod"
                    [(ngModel)]="checkoutData.paymentType"
                    (change)="onPaymentTypeChange(); saveCheckoutData()"
                  />
                  <label
                    class="form-check-label fw-bold"
                    for="formCheck-2"
                    style="font-style: italic"
                    >PayPal</label
                  >
                </div>
                <div class="form-check" name="">
                  <input
                    class="form-check-input"
                    type="radio"
                    id="formCheck-3"
                    value="CreditCard"
                    name="paymentMethod"
                    [(ngModel)]="checkoutData.paymentType"
                    (change)="onPaymentTypeCreditCard(); saveCheckoutData()"
                  />
                  <label class="form-check-label fw-bold" for="formCheck-3"
                    >Credit Card</label
                  >
                </div>
              </div>
            </div>
          </section>

          <ng-container
            *ngIf="
              checkoutData?.paymentType === 'CreditCard';
              else payWithPayPal
            "
          >
            <div class="col-12 col-md-6">
              <h6 class="fw-bold">Enter Credit Card Info</h6>
              <div id="card-element" class="p-3 border rounded"></div>
              <button
                class="btn btn-primary w-100 primary-button mt-3"
                type="button"
                style="
                  font-size: 20px;
                  font-weight: bold;
                  background-color: #fb7701;
                  border-style: none;
                "
                [disabled]="!checkoutForm.valid || !clientSecret"
                (click)="placeOrder()"
              >
                Place Order
              </button>
            </div>
          </ng-container>

          <ng-template #payWithPayPal>
            <section>
              <div class="row mb-4">
                <div class="col">
                  <h6>PayPal Payment</h6>
                  <div id="paypal-button-container"></div>
                </div>
              </div>
            </section>
          </ng-template>

          <!-- <ng-container
            *ngIf="
              checkoutData?.paymentType === 'CreditCard';
              else payWithPayPal
            "
          >
            <div class="col-12 col-md-6">
              <h6 class="fw-bold">Enter Credit Card Info</h6>
              <div id="card-element" class="p-3 border rounded"></div>
              <button
                class="btn btn-primary w-100 primary-button mt-3"
                type="button"
                style="
                  font-size: 20px;
                  font-weight: bold;
                  background-color: #fb7701;
                  border-style: none;
                "
                [disabled]="!checkoutForm.valid || !clientSecret"
                (click)="placeOrder()"
              >
                Place Order
              </button>
            </div>
          </ng-container>

          <ng-template #payWithPayPal>
            <section *ngIf="showPayPal">
              <div class="row mb-4">
                <div class="col">
                  <h6>PayPal Payment</h6>
                  <div id="paypal-button-container"></div>
                </div>
              </div>
            </section>
          </ng-template> -->
        </div>
        <div class="col col-12 col-md-4">
          <app-order-summary (cartTotalEvent)="setCartTotal($event)" />
        </div>
      </div>
    </section>
  </form>
</div>
